<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started â€¢ dml</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="dml">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dml</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dml.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Basics.html">Basics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MartinSpindler/DML/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="dml_files/header-attrs-2.3/header-attrs.js"></script><script src="dml_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MartinSpindler/DML/blob/master/vignettes/dml.Rmd"><code>vignettes/dml.Rmd</code></a></small>
      <div class="hidden name"><code>dml.Rmd</code></div>

    </div>

    
    
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h2>
<p>The purpose of the following case-studies is to demonstrate the core functionalities of <code>DoubleML</code>.</p>
</div>
<div id="data-and-the-causal-model" class="section level2">
<h2 class="hasAnchor">
<a href="#data-and-the-causal-model" class="anchor"></a>Data and the causal model</h2>
<p><code>DoubleML</code> provides interfaces to <code>data.table</code> as well as <code>matrix</code> and <code>data.frame</code>. The usage of the interfaces is demonstrated in the following. We load the 401(k) data set.</p>
<pre><code>from doubleml.datasets import fetch_401K

# Load data
df_401k = fetch_401K()
df_401k.head(5)</code></pre>
<p>Partially linear regression (PLR) models ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<p>Exemplarily we specify a partially linear regression model (PLR). <strong>Partially linear regression (PLR)</strong> models take the form</p>
<p>.. math::</p>
<pre><code>Y = D \theta_0 + g_0(X) + \zeta, &amp; &amp;\mathbb{E}(\zeta | D,X) = 0,

D = m_0(X) + V, &amp; &amp;\mathbb{E}(V | X) = 0,</code></pre>
<p>where :math:<code>Y</code> is the outcome variable and :math:<code>D</code> is the policy variable of interest. The high-dimensional vector :math:<code>X = (X_1, \ldots, X_p)</code> consists of other confounding covariates, and :math:<code>\zeta</code> and :math:<code>V</code> are stochastic errors.</p>
<p>DoubleMLData from pandas DataFrames ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<p>The :class:<code>~doubleml.double_ml_data.DoubleMLData</code> class serves as data-backend and can be initialized from a :py:class:<code>pandas.DataFrame</code> by specifying the column <code>y_col='net_tfa'</code> serving as outcome variable :math:<code>Y</code>, the column(s) <code>d_cols = 'e401'</code> serving as treatment variable :math:<code>D</code> and the columns <code>x_cols=['age', 'inc', 'educ', 'fsize', 'marr', 'twoearn', 'db', 'pira', 'hown']</code> specifying the confounders.</p>
<p>.. ipython:: python</p>
<pre><code>from doubleml import DoubleMLData

# Specify the data and the variables for the causal model
obj_dml_data_401k = DoubleMLData(df_401k,
                                 y_col='net_tfa',
                                 d_cols='e401',
                                 x_cols=['age', 'inc', 'educ', 'fsize', 'marr',
                                         'twoearn', 'db', 'pira', 'hown'])
print(obj_dml_data_401k)</code></pre>
<p>DoubleMLData from numpy arrays ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<p>To introduce the :py:class:<code>numpy.ndarray</code> interface we generate a data set consisting of confounding variables <code>X</code>, an outcome variable <code>y</code> and a treatment variable <code>d</code></p>
<p>.. ipython:: python</p>
<pre><code>import numpy as np

# Generate data
n_obs = 500
n_vars = 100
theta = 3
X = np.random.normal(size=(n_obs, n_vars))
d = np.dot(X[:, :3], np.array([5, 5, 5])) + np.random.standard_normal(size=(n_obs,))
y = theta * d + np.dot(X[:, :3], np.array([5, 5, 5])) + np.random.standard_normal(size=(n_obs,))</code></pre>
<p>To specify the data and the variables for the causal model from :py:class:<code>numpy.ndarray</code> we call</p>
<p>.. ipython:: python</p>
<pre><code>from doubleml import DoubleMLData

obj_dml_data_sim = DoubleMLData.from_arrays(X, y, d)
print(obj_dml_data_sim)</code></pre>
</div>
<div id="estimate-a-causal-model-with-doubledebiased-machine-learning" class="section level2">
<h2 class="hasAnchor">
<a href="#estimate-a-causal-model-with-doubledebiased-machine-learning" class="anchor"></a>Estimate a causal model with double/debiased machine learning</h2>
<p>Machine learners to estimate the nuisance models ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<p>To estimate our partially linear regression (PLR) model with the double machine learning algorithm, we first have to specify machine learners to estimate :math:<code>m_0</code> and :math:<code>g_0</code>. For the 401(k) data we use :py:class:<code>~sklearn.ensemble.RandomForestRegressor</code> from :py:mod:<code>sklearn.ensemble</code> and for our simulated data from a sparse linear model we use :py:class:<code>~sklearn.linear_model.Lasso</code> from :py:mod:<code>sklearn.linear_model</code>.</p>
<p>.. ipython:: python</p>
<pre><code>from sklearn.base import clone
from sklearn.ensemble import RandomForestRegressor
from sklearn.linear_model import Lasso

learner = RandomForestRegressor(max_depth=2, n_estimators=100)
ml_learners_401k = {'ml_m': clone(learner),
                    'ml_g': clone(learner)}

learner = Lasso(alpha=np.sqrt(np.log(n_vars)/(n_obs)))
ml_learners_sim = {'ml_m': clone(learner),
                   'ml_g': clone(learner)}</code></pre>
<p>Cross-fitting, DML algorithms and Neyman-orthogonal score functions ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<p>When initializing the object for PLR models :class:<code>~doubleml.double_ml_plr.DoubleMLPLR</code>, we can further set parameters specifying the resampling: The number of folds used for cross-fitting <code>n_folds</code> (defaults to <code>n_folds = 5</code>) as well as the number of repetitions when applying repeated cross-fitting <code>n_rep_cross_fit</code> (defaults to <code>n_rep_cross_fit = 1</code>). Additionally, one can choose between the algorithms <code>'dml1'</code> and <code>'dml2'</code> via <code>dml_procedure</code>. Depending on the causal model, one can further choose between different Neyman-orthogonal score / moment functions.</p>
<p>DoubleMLPLR: Double/debiased machine learning for partially linear regression models ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<p>We now initialize :class:<code>~doubleml.double_ml_plr.DoubleMLPLR</code> objects for our examples using default parameters</p>
<p>.. ipython:: python</p>
<pre><code>from doubleml import DoubleMLPLR
obj_dml_plr_401k = DoubleMLPLR(obj_dml_data_401k, ml_learners_401k)
obj_dml_plr_sim = DoubleMLPLR(obj_dml_data_sim, ml_learners_sim)</code></pre>
<p>Estimate double/debiased machine learning models ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<p>The models are estimated by calling the <code>fit()</code> method and we can inspect the estimated treatment effect using the <code>summary</code> property.</p>
<p>.. ipython:: python</p>
<pre><code>obj_dml_plr_401k.fit()
print(obj_dml_plr_401k.summary)

obj_dml_plr_sim.fit()
print(obj_dml_plr_sim.summary)</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Philipp Bach, Victor Chernozhukov, Malte Kurz, Martin Spindler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
